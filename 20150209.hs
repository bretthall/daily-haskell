{--

Solution to @1HaskellADay http://lpaste.net/120196

From Mensa Genuis Quiz-a-Day Book, February 9th:

The following addition example uses letters instead of numbers. Each letter
must be replaced with a number -- the same number each time the letter appears.
The puzzle will then be correct, mathematically.

                  OH
                  OH
                  OH
                  OH
                 ---
                  NO

[ed: in the original problem, 'NO' has an exclamation mark! Does this make
a difference to the solution?]

--}

-- Seems kind of underspecified, is 0 OK? (Accoding to the
-- @1HaskellADay it isn't). Is this only in base 10? For kicks lets
-- see what we get in other bases.

type Base = Int
type Digit = Int

ohno :: Base -> [(Digit, Digit, Digit)]
ohno b =  [(o, h, n) | o <- digits, h <- digits, n <- digits, 4*(o*b + h) == n*b + o]
    where 
      maxDigit = b - 1
      digits = [1 .. maxDigit]

ohnoExclaim :: Base -> [(Digit, Digit, Digit, Digit)]
ohnoExclaim b = [(o, h, n, e) | o <- digits, h <- digits, n <- digits, e <- digits, 4*(o*b + h) == n*b*b + o*b + e]
    where 
      maxDigit = b - 1
      digits = [1 .. maxDigit]

{--
*Main> ohno 10
[(2,3,9)]
*Main> ohnoExclaim 10
[(3,3,1,2),(3,4,1,6),(6,6,2,4),(6,7,2,8),(9,8,3,2),(9,9,3,6)]

Adding the ! opens up losts more possiblities

*Main> ohno 2
[]
*Main> ohno 8
[]
*Main> ohno 16
[]
 Hmm, no binary, hex or octal solutions

I wonder where there are solutions:

*Main> mapM_ print $ map (\b -> (b, ohno b)) [2..50]
(2,[])
(3,[])
(4,[])
(5,[])
(6,[])
(7,[(1,2,5)])
(8,[])
(9,[(1,7,7)])
(10,[(2,3,9)])
(11,[(1,3,5),(2,6,10)])
(12,[])
(13,[(1,10,7),(2,7,10)])
(14,[(2,4,9),(2,11,11)])
(15,[(1,4,5),(2,8,10)])
(16,[])
(17,[(1,13,7),(2,9,10),(3,5,13),(4,1,16)])
(18,[(2,5,9),(2,14,11),(4,1,16)])
(19,[(1,5,5),(2,10,10),(3,15,15),(4,1,16)])
(20,[(4,1,16),(4,6,17),(4,11,18),(4,16,19)])
(21,[(1,16,7),(2,11,10),(3,6,13),(4,1,16)])
(22,[(2,6,9),(2,17,11),(4,1,16),(4,12,18)])
(23,[(1,6,5),(2,12,10),(3,18,15),(4,1,16),(5,7,21)])
(24,[(4,1,16),(4,7,17),(4,13,18),(4,19,19)])
(25,[(1,19,7),(2,13,10),(3,7,13),(4,1,16),(5,20,23)])
(26,[(2,7,9),(2,20,11),(4,1,16),(4,14,18),(6,8,25)])
(27,[(1,7,5),(2,14,10),(3,21,15),(4,1,16),(5,8,21),(6,15,26)])
(28,[(4,1,16),(4,8,17),(4,15,18),(4,22,19)])
(29,[(1,22,7),(2,15,10),(3,8,13),(4,1,16),(5,23,23),(6,16,26)])
(30,[(2,8,9),(2,23,11),(4,1,16),(4,16,18),(6,9,25),(6,24,27)])
(31,[(1,8,5),(2,16,10),(3,24,15),(4,1,16),(5,9,21),(6,17,26)])
(32,[(4,1,16),(4,9,17),(4,17,18),(4,25,19)])
(33,[(1,25,7),(2,17,10),(3,9,13),(4,1,16),(5,26,23),(6,18,26),(7,10,29),(8,2,32)])
(34,[(2,9,9),(2,26,11),(4,1,16),(4,18,18),(6,10,25),(6,27,27),(8,2,32)])
(35,[(1,9,5),(2,18,10),(3,27,15),(4,1,16),(5,10,21),(6,19,26),(7,28,31),(8,2,32)])
(36,[(4,1,16),(4,10,17),(4,19,18),(4,28,19),(8,2,32),(8,11,33),(8,20,34),(8,29,35)])
(37,[(1,28,7),(2,19,10),(3,10,13),(4,1,16),(5,29,23),(6,20,26),(7,11,29),(8,2,32)])
(38,[(2,10,9),(2,29,11),(4,1,16),(4,20,18),(6,11,25),(6,30,27),(8,2,32),(8,21,34)])
(39,[(1,10,5),(2,20,10),(3,30,15),(4,1,16),(5,11,21),(6,21,26),(7,31,31),(8,2,32),(9,12,37)])
(40,[(4,1,16),(4,11,17),(4,21,18),(4,31,19),(8,2,32),(8,12,33),(8,22,34),(8,32,35)])
(41,[(1,31,7),(2,21,10),(3,11,13),(4,1,16),(5,32,23),(6,22,26),(7,12,29),(8,2,32),(9,33,39)])
(42,[(2,11,9),(2,32,11),(4,1,16),(4,22,18),(6,12,25),(6,33,27),(8,2,32),(8,23,34),(10,13,41)])
(43,[(1,11,5),(2,22,10),(3,33,15),(4,1,16),(5,12,21),(6,23,26),(7,34,31),(8,2,32),(9,13,37),(10,24,42)])
(44,[(4,1,16),(4,12,17),(4,23,18),(4,34,19),(8,2,32),(8,13,33),(8,24,34),(8,35,35)])
(45,[(1,34,7),(2,23,10),(3,12,13),(4,1,16),(5,35,23),(6,24,26),(7,13,29),(8,2,32),(9,36,39),(10,25,42)])
(46,[(2,12,9),(2,35,11),(4,1,16),(4,24,18),(6,13,25),(6,36,27),(8,2,32),(8,25,34),(10,14,41),(10,37,43)])
(47,[(1,12,5),(2,24,10),(3,36,15),(4,1,16),(5,13,21),(6,25,26),(7,37,31),(8,2,32),(9,14,37),(10,26,42)])
(48,[(4,1,16),(4,13,17),(4,25,18),(4,37,19),(8,2,32),(8,14,33),(8,26,34),(8,38,35)])
(49,[(1,37,7),(2,25,10),(3,13,13),(4,1,16),(5,38,23),(6,26,26),(7,14,29),(8,2,32),(9,39,39),(10,27,42),(11,15,45),(12,3,48)])
(50,[(2,13,9),(2,38,11),(4,1,16),(4,26,18),(6,14,25),(6,39,27),(8,2,32),(8,27,34),(10,15,41),(10,40,43),(12,3,48)])

Starts getting slow out at base 50 so lets quit there. 
--}
